---
// src/components/content/GentleNote.astro
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GentleNote â€” Knowledge-First Soft CTA
// Source: Constitution Â§11, Â§12 | TAD v4.2 Â§4.4 | PRD v4 Â§4.5
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//
// PURPOSE: A gentle, non-aggressive nudge at the end of articles and services.
//          It bridges the "knowledge layer" to the "local layer"
//          without breaking the site's authority tone.
//
// TONE:   "If you need help, we're here." â€” NOT "BUY NOW!"
// DATA:   ALL location data comes from location.ts (never hardcoded)
// DESIGN: Light gray box (#F9FAFB), no attractive colors (FR-GN4)
// TEXT:   Changes dynamically based on category (FR-GN2)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

import { currentLocation } from "../../config/location";

interface Props {
  lang?: "ar" | "en";
  category?: string; // e.g., 'hdd', 'ssd', 'flash', 'raid'
}

const { lang = "ar", category = "general" } = Astro.props;

const isArabic = lang === "ar";
const facility = isArabic
  ? currentLocation.facilityName.ar
  : currentLocation.facilityName.en;
const city = isArabic
  ? currentLocation.city.ar
  : currentLocation.city.en;

// Fallback to general note if category is not found in gentleNotes mapping
const noteCategory = (currentLocation.gentleNotes as Record<string, any>)[category] 
  ? category 
  : "general";

const noteText = isArabic
  ? (currentLocation.gentleNotes as Record<string, any>)[noteCategory].ar
  : (currentLocation.gentleNotes as Record<string, any>)[noteCategory].en;

const whatsappLabel = isArabic ? "ØªÙˆØ§ØµÙ„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨" : "WhatsApp Consultation";
const mapsLabel = isArabic ? `Ø²ÙˆØ±Ù†Ø§ ÙÙŠ ${city}` : `Visit us in ${city}`;
---

<aside
  class="gentle-note"
  role="complementary"
  aria-label={isArabic ? "Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ø³Ø§Ø¹Ø¯Ø©" : "Help Note"}
>
  <p class="gentle-note__icon">ğŸ’¡</p>
  <p class="gentle-note__text">{noteText}</p>
  <div class="gentle-note__links">
    <a
      href={currentLocation.contact.whatsappUrl}
      target="_blank"
      rel="noopener noreferrer"
      class="gentle-note__link"
    >
      {whatsappLabel}
    </a>
    <a
      href={currentLocation.googleMapsUrl}
      target="_blank"
      rel="noopener noreferrer"
      class="gentle-note__link"
    >
      {mapsLabel}
    </a>
  </div>
</aside>

<style>
  .gentle-note {
    margin-block: 2.5rem;
    padding: 1.5rem;
    border-inline-start: 4px solid #D1D5DB; /* Tailwind gray-300 */
    background-color: #F9FAFB; /* Tailwind gray-50 */
    border-radius: 0.5rem;
  }

  .gentle-note__icon {
    font-size: 1.25rem;
    margin-block-end: 0.5rem;
  }

  .gentle-note__text {
    font-size: 1rem;
    line-height: 1.7;
    color: #4B5563; /* Tailwind gray-600 */
    margin: 0;
  }

  .gentle-note__links {
    display: flex;
    gap: 1.25rem;
    margin-block-start: 1rem;
    flex-wrap: wrap;
  }

  .gentle-note__link {
    font-size: 0.9rem;
    color: #374151; /* Tailwind gray-700 */
    text-decoration: underline;
    text-decoration-color: #9CA3AF; /* Tailwind gray-400 */
    text-underline-offset: 4px;
    font-weight: 500;
    transition: all 0.2s ease;
  }

  .gentle-note__link:hover {
    color: #111827; /* Tailwind gray-900 */
    text-decoration-color: #4B5563;
  }
</style>
